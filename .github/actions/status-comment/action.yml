name: 'Create Status Comment'
description: 'Create or update a status comment on the pull request'

inputs:
  token:
    description: 'GitHub token'
    required: true
  lint-status:
    description: 'Lint status (success/failure)'
    required: true
  test-status:
    description: 'Test status (success/failure)'
    required: true

runs:
  using: 'composite'
  steps:
    - name: Generate status summary
      id: status
      run: |
        if [ "${{ inputs.lint-status }}" = "success" ] && [ "${{ inputs.test-status }}" = "success" ]; then
          echo "overall=âœ… All checks passed!" >> $GITHUB_OUTPUT
          echo "color=green" >> $GITHUB_OUTPUT
        else
          echo "overall=âŒ Some checks failed" >> $GITHUB_OUTPUT
          echo "color=red" >> $GITHUB_OUTPUT
        fi

        lint_icon="âœ…"
        if [ "${{ inputs.lint-status }}" != "success" ]; then
          lint_icon="âŒ"
        fi

        test_icon="âœ…"
        if [ "${{ inputs.test-status }}" != "success" ]; then
          test_icon="âŒ"
        fi

        echo "lint_icon=$lint_icon" >> $GITHUB_OUTPUT
        echo "test_icon=$test_icon" >> $GITHUB_OUTPUT
      shell: bash

    - name: Create or update comment
      uses: peter-evans/create-or-update-comment@v5
      with:
        token: ${{ inputs.token }}
        issue-number: ${{ github.event.pull_request.number }}
        body: |
          ## ğŸš€ Pull Request Status

          ### Code Quality
          ${{ steps.status.outputs.lint_icon }} **Linting**: ${{ inputs.lint-status == 'success' && 'Passed' || 'Failed' }}

          ### Testing
          ${{ steps.status.outputs.test_icon }} **Unit Tests**: ${{ inputs.test-status == 'success' && 'Passed' || 'Failed' }}

          ### Overall Status
          **${{ steps.status.outputs.overall }}**

          ---
          *This comment was automatically generated by the CI pipeline.*
        edit-mode: replace
